<?xml version="1.0" encoding="UTF-8"?>
<!-- 
<list-template xmlns="https://github.com/hongjinqiu/javameta/template" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="https://github.com/hongjinqiu/javameta/template https://raw.githubusercontent.com/hongjinqiu/javameta/master/src/schema/schema.xsd">
 -->
<form-template xmlns="https://github.com/hongjinqiu/javameta/template" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<id>GatheringBillSelector</id>
	<cookie name="GatheringBill" />
	<data-source-model-id>GatheringBill</data-source-model-id>

	<adapter name="com.javameta.model.adapter.FormTemplateAdapter" />
	<description>收款单列表</description>
	<scripts>js/ds_listtoolbar.js&amp;gatheringbill/gatheringBillListTemplate.js</scripts>
	<view-template view="model/selectorSchema.jsp" />

	<security byUnit="true" />

	<toolbar name="toolbar" export="true">
		<button text="新增" mode="url" handler="/schema/formschema.do?@name=GatheringBill" iconCls="but_box" />
		<button text="删除" mode="fn" handler="listLimitControlDeleteDataGroup" iconCls="but_box">
		</button>
	</toolbar>

	<data-provider name="queryDataSetA" size="10" sqlIntercept="com.geeboo.cm.pub.query.CmMbQuerySqlIntercept">
		<sql>   
			SELECT *
				 	FROM CM_MB_BUYPACKAGE T1
				 	LEFT JOIN CM_MB_MEMBER T2 ON T2.MB_MEMBER_ID = T1.MEMBER_ID
				 	LEFT JOIN CM_MB_MEMCARD T3 ON T3.MB_MEMCARD_ID=T2.MB_MEMCARD_ID
				 	LEFT JOIN cm_customers T5 ON T5.CUSTOMERS_ID=T2.CUSTOMERS_ID
				 	LEFT JOIN CM_CAR T6 ON T6.CAR_ID=T2.CAR_ID
				 	LEFT JOIN CM_MB_ACTIVITY_PACKAGE T11 ON T11.MB_ACTIVITY_PACKAGE_ID=T1.ACTIVITY_PACKAGE_ID
				 	LEFT JOIN HR_EMPLOYEE T12 ON T12.EMPLOYEE_ID=T1.HANDLE_BY
				 	LEFT JOIN PUB_UNIT T13 ON T13.UNIT_ID=T1.HANDLE_UNIT
				 	LEFT JOIN CM_MB_MEMCARD_GRADE G ON G.MB_MEMCARD_GRADE_ID = T3.MEMCARD_LEVEL
 		</sql>
 		<query-parameters dataSetId="A">
			<query-parameter name="billDateBegin" columnName="billDate" auto="true" text="单据日期从" restriction="ge" />
			<query-parameter name="billDateEnd" columnName="billDate" auto="true" text="单据日期到" restriction="le" />
			<query-parameter name="billNo" auto="true" text=""></query-parameter>
			<query-parameter name="billStatus" auto="true" text=""></query-parameter>
			<query-parameter name="property" auto="true" text="">
				<parameter-attribute name="observe" value="accountId" />
			</query-parameter>
			<query-parameter name="accountId" auto="true" text="">
				<relationDS>
					<relationItem name="CashAccount">
						<relationConfig selectionMode="multi" />
					</relationItem>
					<relationItem name="BankAccount">
						<relationConfig selectionMode="multi" />
					</relationItem>
					<relationItem name="Null">
						<relationConfig selectionMode="multi" />
					</relationItem>
				</relationDS>
			</query-parameter>
			<query-parameter name="chamberlainType" auto="true" text="">
				<parameter-attribute name="observe" value="chamberlainId" />
			</query-parameter>
			<query-parameter name="chamberlainId" auto="true" text="">
				<relationDS>
					<relationItem name="Customer">
						<relationConfig selectionMode="multi" />
					</relationItem>
					<relationItem name="Provider">
						<relationConfig selectionMode="multi" />
					</relationItem>
					<relationItem name="SysUser">
						<relationConfig selectionMode="multi" />
					</relationItem>
					<relationItem name="Null">
						<relationConfig selectionMode="multi" />
					</relationItem>
				</relationDS>
			</query-parameter>
			<query-parameter name="amtGatheringBegin" columnName="amtGathering" auto="true" text="收款金额从" restriction="ge" />
			<query-parameter name="amtGatheringEnd" columnName="amtGathering" auto="true" text="收款金额到" restriction="le" />
			<query-parameter name="chamberlainDesc" auto="true" text=""></query-parameter>
		</query-parameters>
	</data-provider>

	<column-model name="A_1" dataSetId="A" dataProvider="queryDataSetA" selectionMode="checkbox" rownumber="true" selectionTitle="已选收款单" selectionTemplate="{code},{name}" sqlOrderBy="code">
		<checkbox-column name="checkboxSelect" hideable="false">
			<expression mode="text"></expression>
		</checkbox-column>
		<id-column name="id" text="编号" hideable="true" />

		<virtual-column name="FUN_C_SELECTOR" text="操作" width="40">
			<buttons>
				<button name="btn_view" text="查看" iconCls="img_look" mode="url!" handler="/schema/formschema.do?@name=GatheringBill&amp;id={id}&amp;formStatus=view">
				</button>
			</buttons>
		</virtual-column>

		<auto-column name="billDate" />
		<auto-column name="billNo" />
		<auto-column name="property" />
		<auto-column name="billStatus" />
		<auto-column name="accountId">
			<relationDS>
				<relationItem name="BankAccount">
					<copyConfig copyDestField="receiveBankId" copySrcField="bankId" />
				</relationItem>
			</relationDS>
		</auto-column>
		<auto-column name="chamberlainType" />
		<auto-column name="chamberlainId" />
		<auto-column name="currencyTypeId" />
		<auto-column name="amtGathering" />
		<auto-column name="receiveBankId" dsFieldMap="BankAccount.A.bankId" />
		<auto-column name="balanceDate" />
	</column-model>
</form-template>
